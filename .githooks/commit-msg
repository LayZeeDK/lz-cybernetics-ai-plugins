#!/bin/sh
# Strip Claude Code attribution lines from commit messages.
# Safety net: catches attribution even when settings/instructions fail.
COMMIT_MSG_FILE=$1

# Create temp file without attribution lines
grep -vF "Generated with" "$COMMIT_MSG_FILE" \
  | grep -vF "Co-Authored-By: Claude" \
  | grep -vF "Co-authored-by: Claude" \
  > "${COMMIT_MSG_FILE}.tmp"

# Remove trailing blank lines left behind
sed -e :a -e '/^\n*$/{$d;N;ba' -e '}' "${COMMIT_MSG_FILE}.tmp" > "$COMMIT_MSG_FILE"
rm -f "${COMMIT_MSG_FILE}.tmp"
